{"version":3,"sources":["app.js","environment.js","main.js","components/game-screen.js","components/restart-overlay.js","components/status.js","services/keystroke-service.js","services/score-service.js","services/screen-service.js","services/snack-service.js","services/snake-service.js","services/timing-service.js","services/touch-service.js","resources/index.js"],"names":["App","keystrokeService","touchService","timingService","eventAggregator","ea","message","debug","testing","configure","Promise","config","longStackTraces","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","plugin","developmentLogging","start","then","setRoot","GameScreenCustomElement","screenService","snakeService","snackService","snakeImages","snackImages","spriteSize","snakeParts","snackNames","names","snacks","animationTime","getAnimationTime","handleTouch","event","publish","snake","roundToSpriteSize","size","Math","floor","snakeImage","index","segments","length","segmentCSS","x","y","rotationStr","rotation","direction","css","snackPosition","snack","left","position","top","attached","self","$arena","$","$body","targetWidth","width","targetHeight","height","setAreaSize","setDomVars","RestartOverlayCustomElement","showOverlay","firstGame","started","pause","addEventListeners","subscribe","StatusCustomElement","score","highScore","resetVars","snacksForIndicator","indicators","speed","response","name","split","toLowerCase","indexOf","push","setTimeout","shift","resetHighscore","KeystrokeService","acceptMoves","myKeypressCallback","keypressInput","bind","setSubscribers","keysOff","keysOn","document","addEventListener","e","keycode","key","ScoreService","multiplier","readHighscore","saveHighscore","update","amount","max","setMultiplier","factor","resetMultiplier","set","expiry","hs","get","initScore","ScreenService","halfSprite","snackSize","halfSnackSize","canvasCenter","limits","setAnimationTime","time","setCanvasCenter","getCanvasCenter","setLimits","w","h","right","bottom","getLimits","canvas","clientWidth","clientHeight","SnackService","mixUp","newSnack","i","nameIndex","samePosition","pos1","pos2","hitSnack","head","neck","removeSnack","randomSnack","random","addSnack","randomIndex","mixSnacks","unMixSnacks","splice","initSnacks","SnakeService","directions","deadSegments","snackMethods","nope","axe","cutSnake","beer","bunny","diamond","gold","ruby","skull","snail","trash","viagra","weed","mod","m","n","step","grow","turnSteps","tail","newTail","segmentSize","hitWall","hitSnake","method","halfSnake","fallDown","crawling","segment","newY","wallHit","newDirection","startsWith","directionChange","minTurnSteps","ceil","stepSize","initSnake","round","accelleration","TimingService","scoreService","steps","fallTimerHandle","stepTimerHandle","baseGrowInterval","baseScoreInterval","baseSnackInterval","baseSpeedupInterval","maxStepInterval","minStepInterval","changeStepInterval","dropInterval","snackDuration","methods","growSlower","speedUp","multiPlyScore","dropSnake","slowDown","growHarder","startGame","resetIntervals","resumeGame","setInterval","drawScreen","stepInterval","growInterval","speedupInterval","snackInterval","clearTimedEvents","clearInterval","pauseGame","restart","scoreInterval","baseSoreInterval","TouchService","$area","clickAreaSize","diagonal","clickX","clickY","layerX","layerY","offset","touch","touches","pageX","pageY"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport $ from 'jquery';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { KeystrokeService } from './services/keystroke-service';\nimport { TouchService } from './services/touch-service';\nimport { TimingService } from './services/timing-service';\n\n@inject(KeystrokeService, TouchService, TimingService, EventAggregator)\n\nexport class App {\n\n    constructor(keystrokeService, touchService, timingService, eventAggregator) {\n        this.keystrokeService = keystrokeService;\n        this.touchService = touchService;\n        this.timingService = timingService;\n        this.ea = eventAggregator;\n        this.message = 'Snake by ashWare';\n    }\n\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n    longStackTraces: environment.debug,\n    warnings: {\n        wForgottenReturn: false\n    }\n});\n\nexport function configure(aurelia) {\n    aurelia.use\n        .standardConfiguration()\n        .feature('resources')\n\n    aurelia.use\n        .plugin('aurelia-cookie');\n\n    if (environment.debug) {\n        aurelia.use.developmentLogging();\n    }\n\n    if (environment.testing) {\n        aurelia.use.plugin('aurelia-testing');\n    }\n\n    aurelia.start().then(() => aurelia.setRoot());\n}\n","import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\nimport { TouchService } from '../services/touch-service';\nimport { ScreenService } from '../services/screen-service';\nimport { SnakeService } from '../services/snake-service';\nimport { SnackService } from '../services/snack-service';\n\n@inject(EventAggregator, TouchService, ScreenService, SnakeService, SnackService)\n\nexport class GameScreenCustomElement {\n\n    constructor(eventAggregator, touchService, screenService, snakeService, snackService) {\n        this.ea = eventAggregator;\n        this.touchService = touchService;\n        this.screenService = screenService;\n        this.snakeService = snakeService;\n        this.snackService = snackService;\n        this.snakeImages = [];\n        this.snackImages = [];\n        this.spriteSize = 16;\n        // images with these names.jpg should exist in /images/..\n        this.snakeParts = this.snakeService.snakeParts;\n        this.snackNames = this.snackService.names;\n        this.snacks = this.snackService.snacks;\n        this.animationTime = () => { return this.screenService.getAnimationTime(); };\n    }\n\n    handleTouch(event) {\n        this.ea.publish('touch', { event: event, snake: this.snakeService.snake });\n        return false;\n    }\n\n    roundToSpriteSize(size) {\n        return Math.floor(size / this.spriteSize) * this.spriteSize;\n    }\n\n    snakeImage(index) {\n        switch (index) {\n            case 0: return 'head';\n            case this.snakeService.snake.segments.length: return 'tail';\n            default: return 'body';\n        }\n    }\n\n    segmentCSS(index, x, y) {\n        let rotationStr = '';\n        if (index == 0) {\n            let rotation = this.snakeService.snake.direction * 90;\n            rotationStr = 'transform: rotate(' + rotation + 'deg);'\n        }\n        let css = 'left: ' + x + 'px; top: ' + y + 'px; ' + rotationStr + ' transition: all ' + this.animationTime + 's linear; -webkit-transition: all ' + this.animationTime() + 's linear;';\n        return css;\n    }\n\n    snackPosition(index) {\n        let snack = this.snackService.snacks[index];\n        return {\n            left: snack.position.x + 'px',\n            top: snack.position.y + 'px'\n        }\n    }\n\n    attached() {\n        let self = this;\n        this.$arena = $('.arena');\n        let $body = $('body');\n        let targetWidth = this.roundToSpriteSize($body.width() - 48);\n        let targetHeight = this.roundToSpriteSize($body.height() - 48);\n        this.$arena.width(targetWidth);\n        this.$arena.height(targetHeight);\n        this.touchService.setAreaSize(this.$arena);\n        this.screenService.setDomVars(this.$arena);\n    }\n\n}\n","import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { TouchService } from '../services/touch-service';\n\n@inject(EventAggregator, TouchService)\nexport class RestartOverlayCustomElement {\n\n    constructor(eventAggregator, touchService) {\n        this.ea = eventAggregator;\n        this.touchService = touchService;\n        this.showOverlay = true;\n        this.firstGame = true;\n        this.started = false;\n        this.pause = false;\n    }\n\n    start() {\n        if (!this.started) {\n            this.ea.publish('start');\n            this.showOverlay = false;\n            this.firstGame = false;\n            this.started = true;\n        }\n    }\n\n    addEventListeners() {\n        this.ea.subscribe('gameOver', response => {\n            this.showOverlay = true;\n            this.started = false;\n        });\n        this.ea.subscribe('start', response => {\n            this.showOverlay = false;\n        });\n        this.ea.subscribe('pause', response => {\n            this.pause = !this.pause;\n        });\n    }\n\n    attached() {\n        this.addEventListeners();\n    }\n\n}","import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\nexport class StatusCustomElement {\n\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.score = 0;\n        this.highScore;\n        this.resetVars();\n        this.snacksForIndicator = 'beer bunny ruby snail viagra weed';\n        this.indicators = [];\n    }\n\n    addEventListeners() {\n        this.ea.subscribe('speed', response => {\n            this.speed = response;\n        });\n        this.ea.subscribe('grow', response => {\n            this.length = response;\n        });\n        this.ea.subscribe('start', response => {\n            this.resetVars();\n        });\n        this.ea.subscribe('score', response => {\n            this.score = response.score;\n            this.highScore = response.highScore;\n        });\n        this.ea.subscribe('snack', response => {\n            this.snack = response;\n            let name = response.split(':')[0].toLowerCase();\n            if (this.snacksForIndicator.indexOf(name) >= 0) {\n                this.indicators.push(name);\n                setTimeout(() => {\n                    this.indicators.shift();\n                    this.snack = '';\n                }, 15000);\n            }\n        });\n        this.ea.subscribe('die', response => {\n            this.snack = response;\n        });\n\n    }\n\n    resetHighscore() {\n        this.ea.publish('resetHigh');\n    }\n\n    resetVars() {\n        this.speed = 0;\n        this.length = 1;\n        this.score = 0;\n        this.snack = '';\n    }\n\n    attached() {\n        this.addEventListeners();\n    }\n\n}\n","import {\n    inject\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\n\nexport class KeystrokeService {\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.acceptMoves = true;\n        this.myKeypressCallback = this.keypressInput.bind(this);\n        this.setSubscribers();\n    }\n\n    keysOff() {\n        this.acceptMoves = false;\n    }\n\n    keysOn() {\n        this.acceptMoves = true;\n    }\n\n    setSubscribers() {\n        document.addEventListener('keydown', this.myKeypressCallback, false);\n        this.ea.subscribe('keysOff', response => {\n            this.keysOff();\n        });\n        this.ea.subscribe('keysOn', response => {\n            this.keysOn();\n        });\n    }\n\n    // This function is called by the aliased method\n    keypressInput(e) {\n        let keycode = event.key; // also for cross-browser compatible\n        (this.acceptMoves) && this.ea.publish('keyPressed', keycode);\n    }\n}","import { inject } from 'aurelia-framework';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { AureliaCookie } from 'aurelia-cookie';\n\n@inject(EventAggregator)\n\nexport class ScoreService {\n\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        // this.cookie = aureliaCookie;\n        this.multiplier = 1;\n        this.score = 0;\n        this.highScore = this.readHighscore();\n        this.ea.subscribe('gameOver', response => { this.saveHighscore() });\n        this.ea.subscribe('resetHigh', response => { this.resetHighscore() });\n    }\n\n    update(amount) {\n        (amount) && (this.score += amount * this.multiplier);\n        this.highScore = Math.max(this.score, this.highScore);\n        this.ea.publish('score', {\n            score: this.score,\n            highScore: this.highScore\n        });\n    }\n\n    setMultiplier(factor) {\n        if (factor) {\n            this.multiplier = factor;\n        } else {\n            this.multiplier = 10;\n        }\n    }\n\n    resetMultiplier() {\n        this.multiplier = 1;\n    }\n\n    saveHighscore() {\n        AureliaCookie.set('highScore', this.highScore, {\n            expiry: -1,\n        });\n    }\n\n    readHighscore() {\n        let hs = AureliaCookie.get('highScore');\n        if (hs > 0) {\n            return hs;\n        }\n        return 0;\n    }\n\n    resetHighscore() {\n        this.highScore = 0;\n        this.saveHighscore();\n    }\n\n    initScore() {\n        this.score = 0;\n    }\n\n}","import {\n    inject\n} from 'aurelia-framework';\n\nexport class ScreenService {\n\n    constructor(eventAggregator) {\n        this.spriteSize = 16;\n        this.halfSprite = this.spriteSize / 2;\n        this.snackSize = 24;\n        this.halfSnackSize = this.snackSize / 2;\n        this.canvasCenter = {};\n        this.limits = {};\n        this.animationTime;\n    }\n\n    setAnimationTime(time) {\n        this.animationTime = time;\n    }\n\n    getAnimationTime() {\n        return this.animationTime;\n    }\n\n    setCanvasCenter(x, y) {\n        this.canvasCenter = {\n            x: x,\n            y: y\n        };\n    }\n\n    getCanvasCenter() {\n        return this.canvasCenter;\n    }\n\n    setLimits(w, h) {\n        this.limits = {\n            right: w,\n            bottom: h,\n            left: 0,\n            top: 0\n        };\n    }\n\n    getLimits() {\n        return this.limits;\n    }\n\n    roundToSpriteSize(size) {\n        return Math.floor(size / this.spriteSize) * this.spriteSize;\n    }\n\n    setDomVars($arena) {\n        this.canvas = $('#arena')[0];\n        this.canvas.width = this.canvas.clientWidth;\n        this.canvas.height = this.canvas.clientHeight;\n        this.setCanvasCenter(\n            this.roundToSpriteSize($arena.width() / 2),\n            this.roundToSpriteSize($arena.height() / 2)\n        );\n        this.setLimits(this.canvas.width, this.canvas.height);\n    }\n\n}","import { inject } from 'aurelia-framework';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { ScreenService } from './screen-service'\n\n@inject(EventAggregator, ScreenService)\n\nexport class SnackService {\n    constructor(eventAggregator, screenService) {\n        this.ea = eventAggregator;\n        this.screenService = screenService;\n        this.snacks = [];\n        this.mixUp = false;\n        this.names = [\n            'axe',\n            'beer',\n            'bunny',\n            'diamond',\n            'gold',\n            'ruby',\n            'skull',\n            'snail',\n            'trash',\n            'viagra',\n            'weed'\n        ]\n    }\n\n    newSnack(x, y, name, i) {\n        let snack = {\n            position: {\n                x: x,\n                y: y\n            },\n            name: name,\n            nameIndex: i\n        }\n        return snack;\n    }\n\n    samePosition(pos1, pos2) {\n        return pos1.x == pos2.x && pos1.y == pos2.y;\n    }\n\n    hitSnack(head, neck) {\n        for (let i = 0; i < this.snacks.length - 1; i++) {\n            let snack = this.snacks[i];\n            if (this.samePosition(snack.position, head) ||\n                this.samePosition(snack.position, neck)) {\n                this.removeSnack(i);\n                if (this.mixUp) {\n                    let randomSnack = Math.floor(Math.random() * this.names.length);\n                    return this.names[randomSnack];\n                } else {\n                    return snack.name;\n                }\n            }\n        }\n        return 'nope';\n    }\n\n    addSnack() {\n        let randomIndex = Math.floor(Math.random() * this.names.length);\n        let snack = this.names[randomIndex];\n        let x = this.screenService.roundToSpriteSize(Math.floor(Math.random() * (this.screenService.limits.right - this.screenService.spriteSize)))\n        let y = this.screenService.roundToSpriteSize(Math.floor(Math.random() * (this.screenService.limits.bottom - this.screenService.spriteSize)))\n        this.snacks.push(this.newSnack(x, y, snack, randomIndex));\n    }\n\n    mixSnacks() {\n        this.mixUp = true;\n    }\n\n    unMixSnacks() {\n        this.mixUp = false;\n    }\n\n    removeSnack(index) {\n        this.snacks.splice(index, 1);\n    }\n\n    initSnacks() {\n        this.snacks = [];\n    }\n\n}","import { inject } from 'aurelia-framework';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { ScreenService } from './screen-service'\nimport { SnackService } from '../services/snack-service';\n\n@inject(EventAggregator, ScreenService, SnackService)\n\nexport class SnakeService {\n    constructor(eventAggregator, screenService, snackService) {\n        this.ea = eventAggregator;\n        this.screenService = screenService;\n        this.snackService = snackService;\n        this.snakeParts = [\n            'head',\n            'body',\n            'tail'\n        ];\n        this.snake = {\n            direction: 0,\n            directions: [\n                [[1, 0], [0, 1, 0, -1]],\n                [[0, 1], [-1, 0, 1, 0]],\n                [[-1, 0], [0, -1, 0, 1]],\n                [[0, -1], [1, 0, -1, 0]],\n                [[0, 0], [0, 0, 0, 0]]\n            ],\n            segments: [],\n            deadSegments: []\n        }\n        this.snackMethods = {\n            nope: () => {\n                void (0);\n            },\n            axe: () => {\n                this.cutSnake();\n                this.ea.publish('snack', 'Axe: lost half of yourself');\n            },\n            beer: () => {\n                this.ea.publish('snack', 'Beer: grow slower for 15 seconds');\n            },\n            bunny: () => {\n                this.ea.publish('snack', 'Bunny: run faster for 15 seconds');\n            },\n            diamond: () => {\n                this.ea.publish('snack', 'Diamond: 10000 points');\n            },\n            gold: () => {\n                this.ea.publish('snack', 'Gold: 1000 points');\n            },\n            ruby: () => {\n                this.ea.publish('snack', 'Ruby: score &times; 10 for 15 seconds');\n            },\n            skull: () => {\n                this.ea.publish('snack', 'Skull: you die');\n            },\n            snail: () => {\n                this.ea.publish('snack', 'Snail: run slower for 15 seconds');\n            },\n            trash: () => {\n                this.ea.publish('snack', 'Trash: trash all extra&rsquo;s');\n            },\n            viagra: () => {\n                this.ea.publish('snack', 'Viagra: grow harder for 15 seconds');\n            },\n            weed: () => {\n                this.ea.publish('snack', 'Weed: high for 15 seconds')\n            }\n        }\n        this.setSubscribers();\n    }\n\n    mod(m, n) {\n        return ((m % n) + n) % n;\n    }\n\n    step(grow) {\n        // limit the rate at which turns are accepted\n        (this.snake.turnSteps > 0) && this.snake.turnSteps--;\n        let tail = this.snake.segments[this.snake.segments.length - 1];\n        let newTail = {};\n        newTail.x = tail.x;\n        newTail.y = tail.y;\n        for (let i = this.snake.segments.length - 1; i > 0; i -= 1) {\n            this.snake.segments[i].x = this.snake.segments[i - 1].x;\n            this.snake.segments[i].y = this.snake.segments[i - 1].y;\n        }\n        this.snake.segments[0].x += this.snake.directions[this.mod(this.snake.direction, 4)][0][0] * this.snake.segmentSize;\n        this.snake.segments[0].y += this.snake.directions[this.mod(this.snake.direction, 4)][0][1] * this.snake.segmentSize;\n        this.hitWall();\n        this.hitSnake();\n        let head = this.snake.segments[0];\n        let neck = head;\n        (this.snake.segments.length > 1) && (neck = this.snake.segments[1]);\n        let method = this.snackService.hitSnack(head, neck).toLowerCase();\n        this.snackMethods[method]();\n        (grow) && (this.snake.segments.push(newTail));\n    }\n\n    cutSnake() {\n        let halfSnake = Math.floor(this.snake.segments.length / 2)\n        this.snake.segments.splice(-halfSnake);\n    }\n\n    fallDown() {\n        this.crawling = false;\n        for (let i = 0; i < this.snake.segments.length; i++) {\n            if (this.snake.deadSegments.indexOf(i) < 0) {\n                let segment = this.snake.segments[i];\n                let newY = (segment.y + 1) * 1.05;\n                if (newY <= this.screenService.limits.bottom) {\n                    segment.y = newY;\n                } else {\n                    this.snake.deadSegments.push(i);\n                }\n            }\n        }\n        if (this.snake.deadSegments.length >= this.snake.segments.length) {\n            this.ea.publish('gameOver');\n        }\n    }\n\n    hitWall() {\n        let head = this.snake.segments[0];\n        let wallHit =\n            head.x > this.limits.right - this.snake.segmentSize ||\n            head.x < this.limits.left ||\n            head.y > this.limits.bottom - this.snake.segmentSize ||\n            head.y < this.limits.top;\n        if (wallHit) {\n            this.ea.publish('die', 'You hit a wall');\n            return true;\n        }\n        return false;\n    }\n\n    hitSnake() {\n        let head = this.snake.segments[0];\n        for (let i = 3; i < this.snake.segments.length - 1; i++) {\n            let segment = this.snake.segments[i];\n            if (this.samePosition(segment, head)) {\n                this.ea.publish('die', 'You tried to bite yourself that&rsquo;s deadly');\n                return true;\n            }\n        }\n        return false;\n    }\n\n    samePosition(pos1, pos2) {\n        return pos1.x == pos2.x && pos1.y == pos2.y;\n    }\n\n    setSubscribers() {\n        let direction = 0;\n        let newDirection = 0;\n        let directions = {\n            'ArrowRight': 0,\n            'ArrowDown': 1,\n            'ArrowLeft': 2,\n            'ArrowUp': 3\n        }\n        this.ea.subscribe('keyPressed', response => {\n            if (response.startsWith('Arrow') && this.snake.turnSteps == 0) {\n                this.snake.turnSteps = 1;\n                let directionChange = this.snake.directions[this.mod(this.snake.direction, 4)][1][directions[response]];\n                this.snake.direction += directionChange;\n            }\n        });\n    }\n\n    minTurnSteps() {\n        return Math.ceil(this.snake.segmentSize / this.snake.stepSize) + 1;\n    }\n\n    initSnake() {\n        this.snake.segmentSize = this.screenService.spriteSize;\n        this.halfSprite = Math.round(this.snake.segmentSize / 2);\n        this.accelleration = 1.01;\n        this.score = 0;\n        this.snake.deadSegments = [];\n        this.snake.stepSize = 16;\n        this.snake.segments = [];\n        this.snake.turnSteps = 0;\n        this.limits = this.screenService.getLimits();\n        let segment = this.screenService.getCanvasCenter();\n        this.snake.segments.push(segment);\n    }\n}","import { inject } from 'aurelia-framework';\nimport { EventAggregator } from 'aurelia-event-aggregator';\nimport { SnakeService } from './snake-service';\nimport { SnackService } from './snack-service';\nimport { ScreenService } from './screen-service';\nimport { ScoreService } from './score-service';\n\n@inject(EventAggregator, SnakeService, SnackService, ScreenService, ScoreService)\n\nexport class TimingService {\n    constructor(eventAggregator, snakeService, snackService, screenService, scoreService) {\n        this.ea = eventAggregator;\n        this.snakeService = snakeService;\n        this.snackService = snackService;\n        this.screenService = screenService;\n        this.scoreService = scoreService;\n\n        this.crawling = false;\n        this.steps = 0;\n        this.speed = 1;\n        this.fallTimerHandle = null;\n        this.stepTimerHandle = null;\n        this.pause = false;\n\n        this.baseGrowInterval = 10;\n        this.baseScoreInterval = 10;\n        this.baseSnackInterval = 10;\n        this.baseSpeedupInterval = 100;\n\n        this.maxStepInterval = 240;\n        this.minStepInterval = 20;\n        this.changeStepInterval = 20;\n\n        this.dropInterval = 10;\n        this.snackDuration = 15000;\n\n        this.methods = {\n            axe: () => {\n                void (0)\n            },\n            beer: () => {\n                this.growSlower();\n            },\n            bunny: () => {\n                this.speedUp();\n            },\n            diamond: () => {\n                this.scoreService.update(10000);\n            },\n            gold: () => {\n                this.scoreService.update(1000);\n            },\n            ruby: () => {\n                this.multiPlyScore()\n            },\n            skull: () => {\n                this.dropSnake();\n            },\n            snail: () => {\n                this.slowDown();\n            },\n            trash: () => {\n                this.snackService.initSnacks();\n            },\n            viagra: () => {\n                this.growHarder();\n            },\n            weed: () => {\n                this.mixSnacks();\n            }\n        }\n\n        this.setSubscribers();\n    }\n\n    startGame() {\n        this.resetIntervals();\n        this.scoreService.initScore();\n        this.snakeService.initSnake();\n        this.snackService.initSnacks();\n        this.crawling = true;\n        this.resumeGame();\n    }\n\n    resumeGame() {\n        this.stepTimerHandle = setInterval(() => {\n            this.drawScreen()\n        }, this.stepInterval);\n    }\n\n    drawScreen() {\n        this.steps += 1;\n        let grow = (this.steps % this.growInterval == 0);\n        grow && this.ea.publish('grow', this.snakeService.snake.segments.length);\n        (this.steps % this.speedupInterval == 0) && this.speedUp();\n        (this.steps % this.snackInterval == 0) && this.snackService.addSnack();\n        this.snakeService.step(grow);\n        this.scoreService.update(this.snakeService.snake.segments.length);\n    }\n\n    dropSnake() {\n        this.fallTimerHandle = setInterval(() => {\n            this.snakeService.fallDown();\n        }, this.dropInterval);\n    }\n\n    speedUp() {\n        if (this.stepInterval > this.minStepInterval) {\n            this.speed += 1;\n            this.clearTimedEvents();\n            this.stepInterval -= this.changeStepInterval;\n            this.screenService.setAnimationTime(this.stepInterval * .001);\n            this.resumeGame();\n            this.ea.publish('speed', this.speed);\n        }\n    }\n\n    slowDown() {\n        if (this.stepInterval < this.maxStepInterval) {\n            this.speed -= 1;\n            this.clearTimedEvents();\n            this.stepInterval += this.changeStepInterval;\n            this.screenService.setAnimationTime(this.stepInterval * .001);\n            this.resumeGame();\n            this.ea.publish('speed', this.speed);\n        }\n    }\n\n    growSlower() {\n        this.growInterval += 5;\n        setTimeout(() => {\n            this.growInterval -= 5;\n        }, this.snackDuration);\n    }\n\n    growHarder() {\n        if (this.growInterval > this.baseGrowInterval) {\n            this.growInterval -= 5;\n            setTimeout(() => {\n                this.growInterval += 5;\n            }, this.snackDuration);\n        }\n    }\n\n    multiPlyScore() {\n        this.scoreService.setMultiplier();\n        setTimeout(() => {\n            this.scoreService.resetMultiplier();\n        }, this.snackDuration);\n    }\n\n    mixSnacks() {\n        this.snackService.mixSnacks();\n        setTimeout(() => {\n            this.snackService.unMixSnacks();\n        }, this.snackDuration);\n    }\n\n    clearTimedEvents() {\n        clearInterval(this.stepTimerHandle);\n        clearInterval(this.fallTimerHandle);\n    }\n\n    pauseGame() {\n        if (this.crawling) {\n            this.pause = !this.pause;\n            if (this.pause) {\n                this.clearTimedEvents();\n            } else {\n                this.resumeGame();\n            }\n        }\n    }\n\n    restart() {\n        if (!this.pause) {\n            this.clearTimedEvents();\n            this.startGame();\n        }\n    }\n\n    setSubscribers() {\n        let direction = 0;\n        this.ea.subscribe('keyPressed', response => {\n            switch (response) {\n                case 'Enter': this.ea.publish('start');\n                    break;\n                case ' ': this.ea.publish('pause');\n                    break;\n            }\n        });\n        this.ea.subscribe('die', response => {\n            this.clearTimedEvents();\n            this.dropSnake();\n        });\n        this.ea.subscribe('start', response => {\n            this.restart();\n        });\n        this.ea.subscribe('pause', response => {\n            this.pauseGame();\n        });\n        this.ea.subscribe('gameOver', response => {\n            this.clearTimedEvents();\n        });\n        this.ea.subscribe('snack', response => {\n            let method = response.split(':')[0].toLowerCase();\n            this.methods[method]();\n        });\n    }\n\n    resetIntervals() {\n        this.stepInterval = this.maxStepInterval;\n        this.screenService.setAnimationTime(this.stepInterval * .001);\n        this.scoreInterval = this.baseSoreInterval;\n        this.growInterval = this.baseGrowInterval;\n        this.speedupInterval = this.baseSpeedupInterval;\n        this.snackInterval = this.baseSnackInterval;\n        this.speed = 1;\n    }\n\n}","import {\n    inject\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\n\nexport class TouchService {\n\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.$area;\n        this.clickAreaSize = {\n            width: 1,\n            height: 1,\n            diagonal: 1\n        }\n        this.ea.subscribe('touch', (response) => {\n            this.handleTouch(response);\n        });\n    }\n\n    setAreaSize($area) {\n        this.$area = $area;\n        this.clickAreaSize.width = $area.width();\n        this.clickAreaSize.height = $area.height();\n        (this.clickAreaSize.width > 0) && (this.clickAreaSize.diagonal = this.clickAreaSize.height / this.clickAreaSize.width);\n    }\n\n    handleTouch(response) {\n        let event = response.event;\n        let snake = response.snake;\n        let clickX;\n        let clickY;\n        if (event.layerX) {\n            clickX = event.layerX;\n            clickY = event.layerY;\n        } else {\n            let offset = this.$area.offset();\n            let touch = event.touches[0];\n            clickX = touch.pageX - offset.left;\n            clickY = touch.pageY - offset.top;\n        }\n        let direction = 'undefined';\n        if (clickY <= clickX * this.clickAreaSize.diagonal) {\n            if (clickY <= (this.clickAreaSize.height - clickX)) {\n                direction = 'ArrowUp';\n            } else {\n                direction = 'ArrowRight';\n            }\n        } else {\n            if (clickY <= (this.clickAreaSize.height - clickX)) {\n                direction = 'ArrowLeft';\n            } else {\n                direction = 'ArrowDown';\n            }\n        }\n        this.ea.publish('keyPressed', direction);\n        return false;\n    }\n\n}","export function configure(config) {\n  //config.globalResources([]);\n}\n"],"sourceRoot":"../src"}