{"version":3,"sources":["app.js","environment.js","keystroke-service.js","main.js","resources/index.js","components/restart-overlay.js","components/status.js"],"names":["App","keystrokeService","eventAggregator","ea","accelleration","message","pause","crawling","spriteSize","stepTimerHandle","fallTimerHandle","snake","directions","deadSegments","growInterval","images","speedUpInterval","segments","stepInterval","steps","turnSteps","crawl","setInterval","stepNdraw","fall","forEach","segment","direction","speedFactor","fallNdraw","fadeArena","grow","speedup","i","advanceSegment","followSegment","drawSegment","hitSnake","hitWall","die","floorHit","length","clearInterval","keysOn","gameOver","position","canvas","height","head","halfSprite","width","self","overlap","segPos","headPos","dx","Math","abs","dy","xOverlap","yOverlap","pauseGame","publish","keysOff","accellerate","parseInt","j","preceder","axis","tail","dir","factor","x","y","push","ctx","imageIndex","save","translate","rotate","PI","drawImage","restore","fillStyle","fillRect","setSubscribers","subscribe","response","startsWith","restart","initSnake","canvasCenter","$arena","setDomVars","document","getElementById","getContext","clientWidth","clientHeight","wallSize","css","limits","right","bottom","left","top","attached","debug","testing","KeystrokeService","acceptMoves","myKeypressCallback","keypressInput","bind","addEventListener","e","keycode","event","key","configure","Promise","config","longStackTraces","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","RestartOverlayCustomElement","showOverlay","addEventListeners","StatusCustomElement","speed"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\nimport $ from 'jquery';\nimport { KeystrokeService } from './keystroke-service';\n\n@inject(KeystrokeService, EventAggregator)\n\nexport class App {\n\n    constructor(keystrokeService, eventAggregator) {\n        this.keystrokeService = keystrokeService;\n        this.ea = eventAggregator;\n        this.accelleration = 1.01;\n        this.message = 'Snake by ashWare';\n        this.pause = false;\n        this.crawling = false;\n        this.spriteSize = 16;\n        this.stepTimerHandle = null;\n        this.fallTimerHandle = null;\n        this.snake = {\n            directions: [\n                [1, 0],\n                [0, 1],\n                [-1, 0],\n                [0, -1],\n                [0, 0]\n            ],\n            deadSegments: 0,\n            growInterval: 10 * this.spriteSize,\n            images: [],\n            speedUpInterval: 100 * this.spriteSize,\n            segments: [],\n            stepInterval: 10,\n            steps: 0,\n            turnSteps: 0\n        }\n    }\n\n    crawl() {\n        this.stepTimerHandle = setInterval(() => {\n            this.stepNdraw();\n        }, this.snake.stepInterval);\n        this.crawling = true;\n    }\n\n    fall() {\n        this.snake.segments.forEach((segment) => {\n            segment.direction = 1;\n            segment.speedFactor = 1;\n        });\n        this.fallTimerHandle = setInterval(() => {\n            this.fallNdraw();\n        }, 0);\n    }\n\n    stepNdraw() {\n        this.fadeArena();\n        this.snake.steps++;\n        // limit the rate at which turns are accepted\n        (this.snake.turnSteps > 0) && this.snake.turnSteps--;\n        (this.snake.steps % this.snake.growInterval == 0) && this.grow();\n        (this.snake.steps % this.snake.speedUpInterval == 0) && this.speedup();\n        this.snake.segments.forEach((segment, i) => {\n            (i == 0) ? this.advanceSegment(i) : this.followSegment(i, i - 1);\n            this.drawSegment(segment, i);\n        });\n        (this.hitSnake() || this.hitWall()) && this.die();\n    }\n\n    fallNdraw() {\n        this.fadeArena();\n        this.snake.segments.forEach((segment, i) => {\n            (segment.direction < 4) && this.advanceSegment(i, true);\n            this.drawSegment(segment, i);\n            if (segment.direction < 4 && this.floorHit(segment)) {\n                this.snake.deadSegments++;\n                segment.direction = 4;\n            }\n        });\n        if (this.snake.deadSegments >= this.snake.segments.length) {\n            clearInterval(this.fallTimerHandle);\n            this.keysOn();\n            this.gameOver();\n        }\n    }\n\n    floorHit(segment) {\n        return segment.position[1] + this.spriteSize / 2 > this.canvas.height;\n    }\n\n    hitWall() {\n        let head = this.snake.segments[0];\n        let halfSprite = this.spriteSize / 2;\n        return head.position[0] > this.canvas.width - halfSprite ||\n            head.position[0] < 0 + halfSprite ||\n            head.position[1] > this.canvas.height - halfSprite ||\n            head.position[1] < 0 + halfSprite;\n    }\n\n    hitSnake() {\n        let self = this;\n        let head = this.snake.segments[0];\n        function overlap(segPos, headPos) {\n            let dx = Math.abs(segPos[0] - headPos[0]);\n            let dy = Math.abs(segPos[1] - headPos[1]);\n            let xOverlap = dx < self.spriteSize / 2;\n            let yOverlap = dy < self.spriteSize / 2;\n            return xOverlap && yOverlap;\n        }\n        for (let i = 1; i < this.snake.segments.length - 1; i++) {\n            let segment = this.snake.segments[i];\n            if (overlap(segment.position, head.position)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    speedup() {\n        if (this.snake.stepInterval > 0) {\n            this.snake.stepInterval--;\n        } else {\n            this.snake.segments.forEach((segment) => {\n                segment.speedFactor += 1;\n            });\n            this.snake.stepInterval = 7;\n        }\n        this.pauseGame();\n        this.pauseGame();\n        this.ea.publish('speedup');\n    }\n\n    die() {\n        this.keysOff();\n        this.crawling = false;\n        clearInterval(this.stepTimerHandle);\n        this.fall();\n    }\n\n    gameOver() {\n        this.ea.publish('gameOver');\n    }\n\n    advanceSegment(i, accellerate) {\n        let segment = this.snake.segments[i];\n        (accellerate) && (segment.speedFactor *= this.accelleration);\n        segment.position[0] += parseInt(this.snake.directions[segment.direction][0] * segment.speedFactor, 10);\n        segment.position[1] += parseInt(this.snake.directions[segment.direction][1] * segment.speedFactor, 10);\n    }\n\n    followSegment(i, j) {\n        let segment = this.snake.segments[i];\n        let preceder = this.snake.segments[j];\n        let dx = Math.abs(preceder.position[0] - segment.position[0]);\n        let dy = Math.abs(preceder.position[1] - segment.position[1]);\n        let axis = (segment.direction % 2 == 0) ? 'x' : 'y';\n        if (preceder.direction !== segment.direction) {\n            if (axis == 'x') {\n                if (dx < this.spriteSize && dy > this.spriteSize) {\n                    segment.direction = preceder.direction;\n                    segment.position[0] = preceder.position[0];\n                }\n            } else {\n                if (dy < this.spriteSize && dx > this.spriteSize) {\n                    segment.direction = preceder.direction;\n                    segment.position[1] = preceder.position[1];\n                }\n            }\n        }\n        this.advanceSegment(i);\n    }\n\n    grow() {\n        let tail = this.snake.segments[this.snake.segments.length - 1];\n        let dir = tail.direction;\n        let factor = tail.speedFactor;\n        let x = tail.position[0] - this.snake.directions[dir][0] * this.spriteSize;\n        let y = tail.position[1] - this.snake.directions[dir][1] * this.spriteSize;\n        this.snake.segments.push(this.segment(dir, factor, x, y));\n        this.ea.publish('grow');\n    }\n\n    drawSegment(segment, i) {\n        let ctx = this.ctx;\n        let imageIndex = 1;\n        switch (i) {\n            case 0: imageIndex = 0;\n                break;\n            case this.snake.segments.length - 1: imageIndex = 2;\n                break;\n        }\n        ctx.save();\n        ctx.translate(segment.position[0], segment.position[1]);\n        (imageIndex !== 1) && ctx.rotate(segment.direction * Math.PI / 2);\n        ctx.drawImage(this.snake.images[imageIndex], -this.spriteSize / 2, -this.spriteSize / 2);\n        ctx.restore();\n    }\n\n    fadeArena() {\n        let ctx = this.ctx;\n        ctx.fillStyle = 'rgba(0,0,0,.1)';\n        ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    setSubscribers() {\n        let direction = 0;\n        this.ea.subscribe('keyPressed', response => {\n            if (response.startsWith('Arrow') && this.snake.turnSteps == 0) {\n                this.snake.turnSteps = 17;\n                switch (response) {\n                    case 'ArrowRight': direction = 0;\n                        break;\n                    case 'ArrowDown': direction = 1;\n                        break;\n                    case 'ArrowLeft': direction = 2;\n                        break;\n                    case 'ArrowUp': direction = 3;\n                        break;\n                }\n                (((direction + 2) % 4) !== this.snake.segments[0].direction) && (this.snake.segments[0].direction = direction);\n            }\n            switch (response) {\n                case 'Enter': this.ea.publish('restart');\n                    break;\n                case ' ': if (this.crawling) { this.ea.publish('pause'); }\n                    break;\n            }\n        });\n        this.ea.subscribe('restart', response => {\n            this.restart();\n        });\n        this.ea.subscribe('pause', response => {\n            this.pauseGame();\n        });\n    }\n\n    segment(direction, speedFactor, x, y) {\n        return {\n            direction: direction,\n            position: [x, y],\n            speedFactor: speedFactor\n        }\n    }\n\n    pauseGame() {\n        this.pause = !this.pause;\n        if (this.pause) {\n            clearInterval(this.stepTimerHandle);\n            clearInterval(this.fallTimerHandle);\n        } else {\n            this.crawl();\n        }\n    }\n\n    restart() {\n        if (!this.pause) {\n            clearInterval(this.stepTimerHandle);\n            clearInterval(this.fallTimerHandle);\n            this.initSnake();\n            this.crawl();\n        }\n    }\n\n    keysOn() {\n        this.ea.publish('keysOn');\n    }\n\n    keysOff() {\n        this.ea.publish('keysOff');\n    }\n\n    initSnake() {\n        let canvasCenter = {\n            x: parseInt(this.$arena.width() / 2, 10),\n            y: parseInt(this.$arena.height() / 2, 10)\n        };\n        this.snake.segments = [];\n        this.snake.deadSegments = 0;\n        this.snake.stepInterval = 10;\n        this.snake.steps = 0;\n        this.snake.turnSteps = 0;\n        this.snake.segments.push(this.segment(0, 1, canvasCenter.x, canvasCenter.y));\n    }\n\n    setDomVars() {\n        this.$arena = $('.arena');\n        this.canvas = document.getElementById('arena');\n        this.ctx = this.canvas.getContext('2d');\n        this.canvas.width = this.canvas.clientWidth;\n        this.canvas.height = this.canvas.clientHeight;\n        this.wallSize = parseInt(this.$arena.css('borderWidth'), 10);\n        this.limits = {\n            right: this.canvas.width - this.wallSize,\n            bottom: this.canvas.height - this.wallSize,\n            left: this.wallSize,\n            top: this.wallSize\n        }\n        this.snake.images = [\n            $('.head')[0],\n            $('.body')[0],\n            $('.tail')[0]\n        ]\n    }\n\n    attached() {\n        this.setDomVars();\n        this.initSnake();\n        this.setSubscribers();\n        $(() => {\n            this.crawl();\n        });\n    }\n\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import {\n    inject\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\n\nexport class KeystrokeService {\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.acceptMoves = true;\n        this.myKeypressCallback = this.keypressInput.bind(this);\n        this.setSubscribers();\n    }\n\n    keysOff() {\n        this.acceptMoves = false;\n    }\n\n    keysOn() {\n        this.acceptMoves = true;\n    }\n\n    setSubscribers() {\n        document.addEventListener('keydown', this.myKeypressCallback, false);\n        this.ea.subscribe('keysOff', response => {\n            this.keysOff();\n        });\n        this.ea.subscribe('keysOn', response => {\n            this.keysOn();\n        });\n    }\n\n    // This function is called by the aliased method\n    keypressInput(e) {\n        // console.log(e);\n        let keycode = event.key; // also for cross-browser compatible\n        (this.acceptMoves) && this.ea.publish('keyPressed', keycode);\n    }\n}","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\nexport class RestartOverlayCustomElement {\n\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.showOverlay = false;\n        this.pause = false;\n    }\n\n    restart() {\n        this.ea.publish('restart');\n        this.showOverlay = false;\n    }\n\n    addEventListeners() {\n        this.ea.subscribe('gameOver', response => {\n            this.showOverlay = true;\n        });\n        this.ea.subscribe('restart', response => {\n            this.showOverlay = false;\n        });\n        this.ea.subscribe('pause', response => {\n            this.pause = !this.pause;\n        });\n    }\n\n    attached() {\n        this.addEventListeners();\n    }\n\n}\n","import {\n    inject,\n    bindable\n} from 'aurelia-framework';\nimport {\n    EventAggregator\n} from 'aurelia-event-aggregator';\n\n@inject(EventAggregator)\nexport class StatusCustomElement {\n\n    constructor(eventAggregator) {\n        this.ea = eventAggregator;\n        this.speed = 0;\n        this.length = 1;\n    }\n\n    addEventListeners() {\n        this.ea.subscribe('speedup', response => {\n            this.speed++;\n        });\n        this.ea.subscribe('grow', response => {\n            this.length++;\n        });\n        this.ea.subscribe('restart', response => {\n            this.length = 1;\n            this.speed = 0;\n        });\n\n    }\n\n    attached() {\n        this.addEventListeners();\n    }\n\n}\n"],"sourceRoot":"../src"}